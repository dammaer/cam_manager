<div style="font-family: monospace; text-align: center; white-space: pre; color: #00FFFF">
 _ _  _ _    _ _  _  _  _  _  _  _
(_(_|| | |  | | |(_|| |(_|(_|(/_| 
                          _|    
</div>

- [Вступление](#Вступление)
- [Описание](#Описание)
    - [Что настраиваем на камерах?](#Что-настраиваем-на-камерах)
    - [Какие модели камер можно настроить?](#Какие-модели-камер-можно-настроить)
    - [Обновление прошивки](#Обновление-прошивки)
- [Установка](#Установка)
- [Как пользоваться](#Как-пользоваться)
- [References](#References)

## Вступление:
![tg_msg](images/tg_msg.jpg)

Специалистам в компании где я работаю часто приходится настраивать большое количество ip камер. По дефолту они имеют статические адреса и необходимо заходить на каждую камеру и выполнять одни и те же рутинные операции: смена разрешения видео, указание ntp сервера, изменение пароля учётной записи, смена настроек сети и т.д.. Конечно же можно сохранить конфигурацию со всеми этими настройками и загружать их на следующие камеры, но не всегда это происходит корректно. Какие-то модели камер вообще не подхватывают сохраненную ранее конфигурацию и загружаются с настройками по-умолчанию.

![tears](images/tears.png)

Я решил облегчить их страдания чтобы они занимались другой более важной работой!

![fil](images/fil.jpg)

## Описание:
Моё решение основывается на использовании библиотеки [ONVIF Client Implementation in Python](https://github.com/yingchengpa/python-onvif2-zeep).

Для простого запуска весь код с помощью **pyinstaller** скопилирован в бинарный файл и распространен ввиде утилиты на рабочие станции сотрудников.

Предполагается, что компьютер с которого происходит настройка камеры, находится в одной с ними сети и имеет второй ip-интерфейс из той же сети как и у камеры.

<details>
<summary><b>Схема</b></summary>
<img src="images/diagram.png"/>
</details>

Конфигурация камер заранее описывается в файлах json для конкретных моделей. Пример: [OMNY-miniBullet2EWDU.json](configs/cam/OMNY/OMNY-miniBullet2EWDU.json).

**На данный  момент утилита умеет:**
- обновлять камеру до последней рабочей версии прошивки (где работает коридорый режим и т.д.)
- настраивать одну камеру
- несколько в режиме настройки с помощью управляемого POE коммутатора
- настраивать одну или несколько камер, если запустить утилиту с **sudo** правами (*без использования управляемого POЕ коммутатора*)
- сбрасывать камеры к заводским настройкам
____
### Что настраиваем на камерах?
- Основной видеопоток (разрешение, качество, битрейт)
- Дополнительный видеопоток (разрешение)
- Убираем лишнюю системную информацию с видеопотока (оставляем только дату и время)
- Таймзона
- NTP сервер
- Создание дополнительного пользователя с правами только на просмотр
- Изменение пароля у пользователя admin
- Смена настроек сети на DHCP
____
### Какие модели камер можно настроить?
<details>
<summary>OMNY</summary>
OMNY A52N 36<br>
OMNY A52SN 36<br>
OMNY A55N 36<br>
OMNY A55SN 28<br>
OMNY A55SN 36<br>
OMNY-ViBe5EZWDU<br>
OMNY-miniBullet2EWDU<br>
OMNY-miniBullet5EWDU<br>
OMNY-miniDome2EWD12V<br>
OMNY-miniDome2EWDU<br>
OMNY-miniDome2M<br>
OMNY-miniDome2M12Vv3<br>
OMNY-miniDome2WDUv3<br>
OMNY-miniDome4WDU<br>
OMNY-miniDome5EU<br>
OMNY-miniDome5EUv2<br>
OMNY_A54N<br>
OMNY_A55N_28
</details>
<details>
<summary>DAHUA</summary>
DH-IPC-HDW2230TP-AS-0280B<br>
DH-IPC-HFW2231TP-ZS
</details>